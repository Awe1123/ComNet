# 3.1.3 运输层的端口

运行在计算机中的应用进程是用进程标识符来标志 的。
但运行在应用层的各种应用进程却不应当让计算机 操作系统指派它的进程标识符。
- 这是因为在互联网上使用的计算机的操作系统种类很多, 而不同的操作系统又使用不同格式的进程标识符。
为了使运行不同操作系统的计算机的应用进程能够 互相通信, 就必须用统一的方法对 TCP/IP 体系的 应用进程进行标识。

## 需要解决的问题

由于进程的创建和撤销都是动态的, 发送方几 乎无法识别其他机器上的进程。
有时我们会改换接收报文的进程, 但并不需要 通知所有发送方。
我们往往需要利用目的主机提供的功能来识别 终点, 而不需要知道实现这个功能的进程。

## 端口号

解决这个问题的方法就是在运输层使用协议端 口号 (protocol port number), 或通常简称为 端口 (port)。
虽然通信的终点是应用进程，但我们可以把端 口想象是通信的终点。
- 因为我们只要把要传送的报文交到目的主机的某一 个合适的目的端口，剩下的工作（即最后交付目的 进程）就由 TCP 来完成。

### 软件端口和硬件端口

在协议栈层间的抽象的协议端口是软件端口。
■ 软件端口是应用层的各种协议进程与运输实体进行 层间交互的一种地址。
路由器或交换机上的端口是硬件端口。
■ 硬件端口是不同硬件设备进行交互的接口。

### TCP/IP运输层端口

- 端口用一个 16 位的端口号进行标志。
- 端口号只具有本地意义，即端口号只是为了标 志本计算机应用层中的各个不同的应用进程。
- 在互联网中, 不同计算机的相同端口号是没有 联系的。

由此可见, 两个计算机中的进程要互相通信, 不仅必须知 道对方的 IP 地址（为了找到对方的计算机）, 而且还要知 道对方的端口号（为了找到对方计算机中的应用进程）。

### 两大类端口

(1) 服务器端使用的端口号
- 熟知端口, 数值一般为 $0 \sim 1023$ 。
= 登记端口号, 数值为 1024 49151, 为没有熟知端口号的应 用程序使用的。使用这个范围的端口号必须在 IANA 登记, 以防止重复。
(2) 客户端使用的端口号
- 又称为短暂端口号, 数值为 49152 65535, 留给客户进程选 择暂时使用。
= 当服务器进程收到客户进程的报文时, 就知道了客户进程所 使用的动态端口号。通信结束后, 这个端口号可供其他客户 进程以后使用。

### 常用的熟知端口

![image-20221019084726160](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20221019084726160.png)